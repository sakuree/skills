# 新建多条数据接口调试

URL: https://hc.jiandaoyun.com/open/14223

## 1. 简介

### 1.1 接口简介

通过新建多条数据接口，可以向指定的表单中添加多条数据。

注：使用 API 添加数据时，会触发的事件有新数据提交提醒、聚合表计算&校验、数据操作日志、数据量统计。也可以通过请求参数来控制是否发起流程。但是不会触发重复值校验、必填校验。

另外，[系统字段](https://hc.jiandaoyun.com/doc/13523) 和以下所列举的字段不支持添加和修改数据：

* 分割线
* 手写签名
* 选择数据、查询
* 流水号（提交后系统生成）

### 1.2 接口版本说明

|  |  |  |
| --- | --- | --- |
| **接口版本** | **更新时间** | **版本说明** |
| v1 | 2021.12.30 | 原始接口 |
| v5 | 2022.10.28 | 在 v1 的基础上，接口请求频率由 5 次/秒提升至 10 次/秒；  参数 app\_id 和 entry\_id 放入 body，接口路由修改为 POST app/entry/data/batch\_create。 |
| 2023.08.31 | 新增请求参数   * 数据提交人：data\_creator |

## 2. 接口调用

创建多条数据接口最多支持 **100** 条数据。

**请求地址**：https://api.jiandaoyun.com/api/v5/app/entry/data/batch\_create

**请求频率：**10 次/秒

**请求方式**：POST

**请求参数：**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **参数** | **类型** | **必需** | **说明** | **默认** |
| app\_id | String | 是 | 应用ID | —— |
| entry\_id | String | 是 | 表单ID |  |
| data\_list | Array | 是 | 数据内容数组 |  |
| data\_creator | String | 否 | 数据提交人（取成员编号 username，可从通讯录接口获取） | 企业创建者 |
| transaction\_id | String | 否 | 事务ID；transaction\_id 用于表示一次事务，用于防止因重试而导致重复创建同一批数据，也用于绑定一批文件，建议使用 UUID 以免重复。 |  |
| is\_start\_workflow | Bool | 否 | 是否发起流程（仅流程表单有效） | false |

**请求示例：**

```
{
  "app_id": "59264073a2a60c0c08e20bfb",
  "entry_id": "59264073a2a60c0c08e20bfd",
  "transaction_id": "87cd7d71-c6df-4281-9927-469094395677",   //事务ID
    "data_list": [
        {
            "_widget_1432728651402": { // 单行文本
                "value": "简道云1"
            },
            "_widget_1432728651403": { // 数字
                "value": 100
            },
         	"_widget_1725969783950": {
          		"value": "67221b4fac0a62ac8f43a1c4"//关联数据
      		},
            "_widget_1528854613291": { // 子表单
                "value": [
                    { // 子表单子记录结构跟主表一致
                        "_widget_1528854614409": {
                            "value": "子表单数据11"
                        },
                        "_widget_1528854615499": {
                            "value": 1001
                        }
                    },
                    {
                        "_widget_1528854614410": {
                            "value": "子表单数据12"
                        },
                        "_widget_1528854615419": {
                            "value": 1002
                        }
                    }
                ]
            }
        }, 
        {
            "_widget_1432728651402": {
                "value": "简道云2"
            },
            "_widget_1432728651403": {
                "value": 200
            },
            "_widget_1528854613291": {
                "value": [
                    {
                        "_widget_1528854614409": {
                            "value": "子表单数据21"
                        },
                        "_widget_1528854615499": {
                            "value": 2001
                        }
                    }
                ]
            }
        },
        {
            "_widget_1432728651402": {
                "value": "简道云3"
            },
            "_widget_1432728651403": {
                "value": 300
            },
            "_widget_1528854613291": {
                "value": [
                    {
                        "_widget_1528854614410": {
                            "value": "子表单数据31"
                        },
                        "_widget_1528854615419": {
                            "value": 3001
                        }
                    }
                ]
            }
        }
    ],
    "is_start_workflow": true
}
```

**响应内容：**

|  |  |  |
| --- | --- | --- |
| **参数** | **类型** | **说明** |
| status | String | 返回请求结果 |
| success\_count | Number | 该 transaction\_id 创建成功的数据条数 |
| success\_ids | Array | 本次请求创建成功的数据的 ID 列表 |

**响应示例：**

```
{
    "status": "success",
    "success_count": 3,
    "success_ids": [
        "200001181fe09728936510eb",
        "200001181fe09728936510ec",
        "200001181fe09728936510ed"
    ]
}
```

## 3. 注意事项

1）新建多条数据，部分数据新建时可能出现失败的情况。处理方法如下所示：

使用同一个 transaction\_id 再次请求新建多条，传入全部数据。执行效果将为新增第一次失败的数据，第一次成功的数据不会重复新增。

2）如果请求中指定了 data\_creator，则关联触发的以下成员也会被记录为 data\_creator，如下所示：

* 智能助手执行人
* 流程发起人
* CRM 相关关联修改

+ 由跟进记录关联修改的客户表、线索表和商机表的修改人
+ 由商机表关联修改的客户表的修改人