# 全量导入部门接口调试

URL: https://hc.jiandaoyun.com/open/18521

## 1. 简介

### 1.1 接口简介

本接口以 dept\_no（部门编号）为主键，全量覆盖企业内的通讯录部门树。仅支持公共模式。

### 1.2 接口版本

|  |  |  |
| --- | --- | --- |
| **接口版本** | **更新时间** | **版本说明** |
| v1 | 2018.12.4 | 使用 \_id 作为 id |
| v2 | 2019.6.21 | 使用 dept\_no 作为 id |
| v4 | 2022.6.30 | 返回值新增字段 type、status、integrate\_id |
| v5 | 2022.10.28 | 在 v4 的基础上，接口请求频率由 5 次每秒提升至 10 次每秒；  接口路由修改为 POST corp/department/import |

## 2. 接口调用

本接口以 dept\_no（部门编号）为主键，全量覆盖企业内的通讯录部门树。仅支持公共模式。

**接口地址：**https://api.jiandaoyun.com/api/v5/corp/department/import

**请求频率：**10 次/秒

**请求方式**：POST

**注意事项：**

1）部门编号为数字类型且唯一。

2）除了根部门以外所有部门的父部门必须存在。如果新导入列表中不存在根部门, 则会自动插入根部门, 且部门名称为企业名称。

3）同级部门名称不能有重复。

4）部门层级不能超过 16 级。

5）如果导入数据存在，且现有企业通讯录中也存在，则更新该部门的信息。

6）如果导入数据存在，而现有企业通讯录中不存在，则新建该部门。

7）如果导入数据不存在，但现有企业通讯录中存在，则继续判断该部门下是否存在子部门和成员，如果都没有则自动删除该部门，否则将子部门和成员转移到根部门下继续保留。

8）该接口允许导入的部门数上限为 100000。

9）该接口调用执行期间，将无法同时调用其他对通讯录的修改、删除、新增接口。

**请求参数：**

|  |  |  |  |
| --- | --- | --- | --- |
| **参数** | **是否必需** | **类型** | **说明** |
| departments | 是 | Array | 部门列表 |
| departments[].dept\_no | 是 | Number | 部门编号（上限 9007199254740991） |
| departments[].name | 是 | String | 部门名称 |
| departments[].parent\_no | 否 | Number | 父部门编号，不传默认为根部门下 |

**请求示例：**

```
{
    "departments": [{
        "dept_no": 11,
        "name": "研发部门",
        "parent_no": 1
    }, {
     "dept_no": 12,
     "name": "测试部门",
     "parent_no": 1
    }]
}
```

注：在使用批量导入部门的 API 接口时，在传入新部门的同时，还需要写入新部门的根部门，以保证部门树结构的完整性。

例如，想在 SSO\_dept 这个部门下插入一个新的子部门，如果只传新部门的话，会报错父部门不存在。

![](https://help-assets.jiandaoyun.com/c1539848-9f0e-4236-9f85-d4c4aaa8166a)

此时需要把 SSO\_dept 部门也传一下，即使该部门已经存在了，但为了树结构的完整性以及新部门的准确插入，需要再次写入。

![](https://help-assets.jiandaoyun.com/b39fbf7d-5a8d-451e-b1d9-d73ad619b175)

最终效果如下：

![](https://help-assets.jiandaoyun.com/9a1e2310-ec47-4ca6-afcb-9a6136112e01)

**响应内容：**

|  |  |  |
| --- | --- | --- |
| **参数** | **类型** | **说明** |
| status | String | 返回请求结果 |

**响应示例：**

```
{
    "status": "success"
}
```